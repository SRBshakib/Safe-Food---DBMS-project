<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warehouse Manager Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css"> <!-- Link to custom CSS -->
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    
</head>
<body>
    <div class="sidebar close">
        <div class="logo-details">
          <i class='bx bxl-c-plus-plus'></i>
          <span class="logo_name">TraceRoots</span>
        </div>
        <ul class="nav-links">
          <li>
            <a href="index.html">
              <i class='bx bx-grid-alt' ></i>
              <span class="link_name">Dashboard</span>
            </a>
          </li>

          <li>
            <a href="productEntry.html">
              <i class='bx bx-pie-chart-alt-2' ></i>
              <span class="link_name">Entry Product</span>
            </a>
            <ul class="sub-menu blank">
              <li><a class="link_name" href="#">Entry Product</a></li>
            </ul>
          </li>
          <li>
            <a href="inventory.html">
              <i class='bx bx-line-chart' ></i>
              <span class="link_name">Inventory</span>
            </a>
            <ul class="sub-menu blank">
              <li><a class="link_name" href="#">Inventory</a></li>
            </ul>
          </li>
          <li>
            <a href="#">
              <i class='bx bx-history'></i>
              <span class="link_name">History</span>
            </a>
            <ul class="sub-menu blank">
              <li><a class="link_name" href="#">History</a></li>
            </ul>
          </li>
          <li>
            <a href="#">
              <i class='bx bx-cog' ></i>
              <span class="link_name">Setting</span>
            </a>
            <ul class="sub-menu blank">
              <li><a class="link_name" href="#">Setting</a></li>
            </ul>
          </li>
          <li>
            <a href="upcoming.html">
              <i class='bx bx-support' ></i>
              <span class="link_name">Upcoming Orders</span>
            </a>
            <ul class="sub-menu blank">
              <li><a class="link_name" href="#">Help and Support</a></li>
            </ul>
          </li>

          <li>
        <div class="profile-details">
          <div class="profile-content">
            <!--<img src="image/profile.jpg" alt="profileImg">-->
          </div>
          <div class="name-job">
            <div class="profile_name">Kamal Hasan</div>
            <div class="job">Warehouse Manager</div>
          </div>
          <i class='bx bx-log-out' ></i>
        </div>
      </li>
    </ul>
      </div>
      <section class="home-section">
        <div class="home-content">
            <i class='bx bx-menu'></i>
            <span class="text">Warehouse Manager Dashboard</span>
        </div>
        <div class="container-fluid default-dashboard">
            <div class="row">
                <!-- Welcome Banner Card -->
                
                <script>
                  // Simulate data for Farm, Batch, and Inspection tables (this would be replaced by actual database queries)
                  const farmData = {
                    'FF001': {
                      farmName: 'Fresh Farms',
                      farmerID: 12345,
                      subDistrict: 'North Valley',
                      district: 'Greenland',
                      division: 'Western',
                      email: 'contact@freshfarms.com',
                      contactNo: '+1234567890',
                      farmType: 'Organic'
                    },
                    'FW002': {
                      farmName: 'FruitWorld',
                      farmerID: 67890,
                      subDistrict: 'East Valley',
                      district: 'Fruitland',
                      division: 'Eastern',
                      email: 'support@fruitworld.com',
                      contactNo: '+9876543210',
                      farmType: 'Commercial'
                    }
                  };
              
                  const batchData = {
                    'B001': {
                      processingDate: '2024-11-01 12:00:00',
                      certification: 'Organic Certified',
                      weight: 2000.00,
                      quantity: 1000,
                      rating: 4.5,
                      productType: 'Apple',
                      lotID: 101
                    },
                    'B002': {
                      processingDate: '2024-11-15 08:00:00',
                      certification: 'Non-Organic',
                      weight: 1500.00,
                      quantity: 1500,
                      rating: 4.0,
                      productType: 'Banana',
                      lotID: 102
                    }
                  };
              
                  const inspectionData = {
                    'B001': {
                      reportID: 201,
                      time: '2024-11-20 10:00:00',
                      date: '2024-11-20',
                      productID: 301,
                      qcoID: 401,
                      warehouseID: 501
                    },
                    'B002': {
                      reportID: 202,
                      time: '2024-11-22 14:30:00',
                      date: '2024-11-22',
                      productID: 302,
                      qcoID: 402,
                      warehouseID: 502
                    }
                  };
              
                  // Show Farm Details Popup
                  function showFarmDetails(farmId) {
                    const farm = farmData[farmId];
                    const farmDetails = `
                      <h2>Farm Details</h2>
                      <p><strong>Farm Name:</strong> ${farm.farmName}</p>
                      <p><strong>Farm ID:</strong> ${farmId}</p>
                      <p><strong>Farmer ID:</strong> ${farm.farmerID}</p>
                      <p><strong>Sub District:</strong> ${farm.subDistrict}</p>
                      <p><strong>District:</strong> ${farm.district}</p>
                      <p><strong>Division:</strong> ${farm.division}</p>
                      <p><strong>Email:</strong> ${farm.email}</p>
                      <p><strong>Contact No:</strong> ${farm.contactNo}</p>
                      <p><strong>Farm Type:</strong> ${farm.farmType}</p>
                      <button onclick="closePopup()">Close</button>
                    `;
                    document.getElementById('popup-content').innerHTML = farmDetails;
                    document.getElementById('popup').style.display = 'block';
                  }
              
                  // Show Batch and Inspection Details Popup
                  function showBatchDetails(batchId) {
                    const batch = batchData[batchId];
                    const inspection = inspectionData[batchId];
                    const batchDetails = `
                      <h2>Batch Details</h2>
                      <p><strong>Batch ID:</strong> ${batchId}</p>
                      <p><strong>Processing Date:</strong> ${batch.processingDate}</p>
                      <p><strong>Certification:</strong> ${batch.certification}</p>
                      <p><strong>Weight:</strong> ${batch.weight} kg</p>
                      <p><strong>Quantity:</strong> ${batch.quantity} units</p>
                      <p><strong>Rating:</strong> ${batch.rating} / 5</p>
                      <p><strong>Product Type:</strong> ${batch.productType}</p>
                      <p><strong>Lot ID:</strong> ${batch.lotID}</p>
                      
                      <h3>Inspection Details</h3>
                      <p><strong>Report ID:</strong> ${inspection.reportID}</p>
                      <p><strong>Inspection Time:</strong> ${inspection.time}</p>
                      <p><strong>Inspection Date:</strong> ${inspection.date}</p>
                      <p><strong>Product ID:</strong> ${inspection.productID}</p>
                      <p><strong>QCO ID:</strong> ${inspection.qcoID}</p>
                      <p><strong>Warehouse ID:</strong> ${inspection.warehouseID}</p>
                      
                      <button onclick="closePopup()">Close</button>
                    `;
                    document.getElementById('popup-content').innerHTML = batchDetails;
                    document.getElementById('popup').style.display = 'block';
                  }
              
                  // Close the popup
                  function closePopup() {
                    document.getElementById('popup').style.display = 'none';
                  }
              
                  // Move a row from the Upcoming Deliveries table to the History table
                  function handleReceive(batchId, productName, quantity, farm, farmId, pickupLocation, transportId) {
                    var row = document.getElementById('row-' + batchId);
                    
                    // Update the status in the Upcoming Deliveries table (Remove Pending)
                    row.cells[7].innerText = ""; // Remove the Pending status
                    
                    // Move the row to the History table (excluding the button)
                    var historyTable = document.getElementById('history-table').getElementsByTagName('tbody')[0];
                    var newRow = historyTable.insertRow(historyTable.rows.length);
              
                    // Add the same data to the history row, excluding the button cell and set status to "Received"
                    newRow.innerHTML = row.innerHTML.replace(/<button.*?<\/button>/, '');
                    newRow.cells[7].innerText = "Received"; // Set status to "Received" in the history table
              
                    // Remove the row from the Upcoming Deliveries table
                    row.remove();
              
                    alert(productName + " from " + farm + " has been received and moved to the history.");
                  }
                </script>
              </head>
              <body>
                <div class="container">
                  <h1>Upcoming Transport Deliveries</h1>
                  <p>Below are the products expected to arrive at the warehouse. You can view the details and update the status once received.</p>
              
                  <!-- Upcoming Deliveries Table -->
                  <table class="delivery-table">
                    <thead>
                      <tr>
                        <th>Transport ID</th>
                        <th>Batch ID</th>
                        <th>Product Name</th>
                        <th>Quantity</th>
                        <th>Farm</th>
                        <th>Pickup Location</th>
                        <th>Status</th>
                        <th>Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr id="row-B001">
                        <td>T001</td>
                        <td><a href="javascript:void(0);" onclick="showBatchDetails('B001')">B001</a></td>
                        <td>Apple</td>
                        <td>1000</td>
                        <td><a href="javascript:void(0);" onclick="showFarmDetails('FF001')">Fresh Farms</a></td>
                        <td>Warehouse A</td>
                        <td>Pending</td>
                        <td>
                          <button class="btn-receive" onclick="handleReceive('B001', 'Apple', '1000', 'Fresh Farms', 'FF001', 'Warehouse A', 'T001')">Receive & Add to Inventory</button>
                        </td>
                      </tr>
                      <tr id="row-B002">
                        <td>T002</td>
                        <td><a href="javascript:void(0);" onclick="showBatchDetails('B002')">B002</a></td>
                        <td>Banana</td>
                        <td>1500</td>
                        <td><a href="javascript:void(0);" onclick="showFarmDetails('FW002')">FruitWorld</a></td>
                        <td>Warehouse B</td>
                        <td>Pending</td>
                        <td>
                          <button class="btn-receive" onclick="handleReceive('B002', 'Banana', '1500', 'FruitWorld', 'FW002', 'Warehouse B', 'T002')">Receive & Add to Inventory</button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
              
                  <!-- History Table -->
                  <h2>Delivery History</h2>
                  <table class="delivery-table" id="history-table">
                    <thead>
                      <tr>
                        <th>Transport ID</th>
                        <th>Batch ID</th>
                        <th>Product Name</th>
                        <th>Quantity</th>
                        <th>Farm</th>
                        <th>Pickup Location</th>
                        <th>Status</th>
                      </tr>
                    </thead>
                    <tbody>
                      <!-- History rows will be added dynamically here -->
                    </tbody>
                  </table>
                </div>
              
                <!-- Farm and Batch Details Popup -->
                <div id="popup" class="popup">
                  <div class="popup-content" id="popup-content">
                    <!-- Farm or Batch details will be dynamically inserted here -->
                  </div>
                </div>
              </body>
          
          
          
          
          
        
          <!-- Inventory Management Card -->
          
      
    </section>
    
    <script>
// Calculate the utilization percentage
const totalCapacity = 1000;
const currentUtilization = 760;
const utilizationPercentage = (currentUtilization / totalCapacity) * 100;

// Update HTML content for Total Capacity and Current Utilization
document.getElementById("totalCapacity").textContent = totalCapacity;
document.getElementById("currentUtilization").textContent = currentUtilization;

// Configure the radial bar chart with adjusted height
var options = {
          series: [76],
          chart: {
          type: 'radialBar',
          offsetY: -20,
          sparkline: {
            enabled: true
          }
        },
        plotOptions: {
          radialBar: {
            startAngle: -90,
            endAngle: 90,
            track: {
              background: "#e7e7e7",
              strokeWidth: '97%',
              margin: 5, // margin is in pixels
              dropShadow: {
                enabled: true,
                top: 2,
                left: 0,
                color: '#999',
                opacity: 1,
                blur: 2
              }
            },
            dataLabels: {
              name: {
                show: false
              },
              value: {
                offsetY: -2,
                fontSize: '22px'
              }
            }
          }
        },
        grid: {
          padding: {
            top: -10
          }
        },
        fill: {
          type: 'gradient',
          gradient: {
            shade: 'light',
            shadeIntensity: 0.4,
            inverseColors: false,
            opacityFrom: 1,
            opacityTo: 1,
            stops: [0, 50, 53, 91]
          },
        },
    labels: ['Utilization'],
};

// Render the chart
var chart = new ApexCharts(document.querySelector("#capacityChart"), options);
chart.render();

      


      // Line Chart for Storage Condition (Temperature & Humidity)
      var optionsStorageCondition = {
          chart: {
              type: 'line',
              height: 250
          },
          series: [
              {
                  name: 'Temperature',
                  data: [24, 23, 22, 24, 26, 25, 23] // Sample temperature data points
              },
              {
                  name: 'Humidity',
                  data: [50, 55, 60, 57, 54, 52, 50] // Sample humidity data points
              }
          ],
          xaxis: {
              categories: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'] // Days of the week
          },
          colors: ['#ff4560', '#008ffb'],
          stroke: {
              width: 3
          }
      };

      var chartStorageCondition = new ApexCharts(document.querySelector("#storageConditionChart"), optionsStorageCondition);
      chartStorageCondition.render();
  </script>
     
  

      <script>
 let sidebar = document.querySelector(".sidebar");
let sidebarBtn = document.querySelector(".bx-menu");
let menuItems = document.querySelectorAll(".nav-links li");

// Open sidebar when mouse is over the menu button
sidebarBtn.addEventListener("mouseover", () => {
  sidebar.classList.remove("close");
});

// Open sidebar when hovering over any <li> item
menuItems.forEach((item) => {
  item.addEventListener("mouseover", () => {
    sidebar.classList.remove("close");
  });
});

// Close sidebar when mouse leaves the sidebar
sidebar.addEventListener("mouseout", () => {
  sidebar.classList.add("close");
});



      </script>
 <script>
  document.querySelector(".welcome-banner").addEventListener("mouseover", () => {
    document.querySelector(".img-1").style.animationPlayState = "paused";
});
document.querySelector(".welcome-banner").addEventListener("mouseout", () => {
    document.querySelector(".img-1").style.animationPlayState = "running";
});

 </script>
 <script>
  function updateTime() {
    const timerElement = document.getElementById("timer");
    const now = new Date();
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');
    const ampm = hours >= 12 ? 'PM' : 'AM';

    timerElement.textContent = `Time: ${hours}:${minutes}:${seconds} ${ampm}`;
}

// Update time every second
setInterval(updateTime, 1000);

// Initialize the time immediately on load
updateTime();
 </script>
</body>

</script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
</html>
